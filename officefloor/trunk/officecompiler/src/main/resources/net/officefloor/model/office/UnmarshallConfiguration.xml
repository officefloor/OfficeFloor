<?xml version="1.0" encoding="UTF-8"?>
<unmarshall node="office" class="net.officefloor.model.office.OfficeModel">
    <!-- EXTERNAL MANAGED OBJECTS -->
    <object method="addExternalManagedObject" node="external-managed-object"
        class="net.officefloor.model.office.ExternalManagedObjectModel">
        <value method="setExternalManagedObjectName" node="external-managed-object@name" />
        <value method="setObjectType" node="external-managed-object@object-type" />
        <value method="setX" node="external-managed-object@x" />
        <value method="setY" node="external-managed-object@y" />
        <object method="addAdministrator" node="administer"
            class="net.officefloor.model.office.ExternalManagedObjectToAdministratorModel">
            <value method="setAdministratorName" node="administer@administrator" />
            <value method="setOrder" node="administer@order" />
        </object>
    </object>
    <!-- OFFICE TEAMS -->
    <object method="addOfficeTeam" node="team"
        class="net.officefloor.model.office.OfficeTeamModel">
        <value method="setOfficeTeamName" node="team@name" />
        <value method="setX" node="team@x" />
        <value method="setY" node="team@y" />
    </object>
    <!-- OFFICE ESCALATIONS -->
    <object method="addOfficeEscalation" node="escalation"
        class="net.officefloor.model.office.OfficeEscalationModel">
        <value method="setEscalationType" node="escalation@escalation-type" />
        <value method="setX" node="escalation@x" />
        <value method="setY" node="escalation@y" />
    </object>
    <!-- OFFICE ADMINISTRATORS -->
    <object method="addOfficeAdministrator" node="administrator"
        class="net.officefloor.model.office.AdministratorModel">
        <value method="setAdministratorName" node="administrator@name" />
        <value method="setAdministratorSourceClassName" node="administrator@source" />
        <value method="setAdministratorScope" node="administrator@scope" />
        <value method="setX" node="administrator@x" />
        <value method="setY" node="administrator@y" />
        <object method="addProperty" node="property"
            class="net.officefloor.model.office.PropertyModel">
            <value method="setName" node="property@name" />
            <value method="setValue" node="property@value" />
        </object>
        <object method="setOfficeTeam" node="team"
            class="net.officefloor.model.office.AdministratorToOfficeTeamModel">
            <value method="setOfficeTeamName" node="team@name" />
        </object>
        <object method="addDuty" node="duty"
            class="net.officefloor.model.office.DutyModel">
            <value method="setDutyName" node="duty@name" />
        </object>
    </object>
    <!-- OFFICE SECTIONS -->
    <object method="addOfficeSection" node="section"
        class="net.officefloor.model.office.OfficeSectionModel">
        <value method="setOfficeSectionName" node="section@name" />
        <value method="setSectionSourceClassName" node="section@source" />
        <value method="setSectionLocation" node="section@location" />
        <value method="setX" node="section@x" />
        <value method="setY" node="section@y" />
        <object method="addProperty" node="property"
            class="net.officefloor.model.office.PropertyModel">
            <value method="setName" node="property@name" />
            <value method="setValue" node="property@value" />
        </object>
        <object method="addOfficeSectionInput" node="input"
            class="net.officefloor.model.office.OfficeSectionInputModel">
            <value method="setOfficeSectionInputName" node="input@name" />
            <value method="setParameterType" node="input@parameter-type" />
        </object>
        <object method="addOfficeSectionOutput" node="output"
            class="net.officefloor.model.office.OfficeSectionOutputModel">
            <value method="setOfficeSectionOutputName" node="output@name" />
            <value method="setArgumentType" node="output@argument-type" />
            <value method="setEscalationOnly" node="output@escalation-only" />
            <object method="setOfficeSectionInput" node="section-input"
                class="net.officefloor.model.office.OfficeSectionOutputToOfficeSectionInputModel">
                <value method="setOfficeSectionName" node="section-input@section" />
                <value method="setOfficeSectionInputName" node="section-input@input" />
            </object>
        </object>
        <object method="addOfficeSectionObject" node="object"
            class="net.officefloor.model.office.OfficeSectionObjectModel">
            <value method="setOfficeSectionObjectName" node="object@name" />
            <value method="setObjectType" node="object@object-type" />
            <object method="setExternalManagedObject" node="external-managed-object"
                class="net.officefloor.model.office.OfficeSectionObjectToExternalManagedObjectModel">
                <value method="setExternalManagedObjectName" node="external-managed-object@name" />
            </object>
        </object>
        <object method="addOfficeSectionResponsibility" node="responsibility"
            class="net.officefloor.model.office.OfficeSectionResponsibilityModel">
            <value method="setOfficeSectionResponsibilityName"
                node="responsibility@name" />
            <object method="setOfficeTeam" node="team"
                class="net.officefloor.model.office.OfficeSectionResponsibilityToOfficeTeamModel">
                <value method="setOfficeTeamName" node="team@name" />
            </object>
            <object method="addOfficeSectionResponsibilityObject"
                node="object"
                class="net.officefloor.model.office.OfficeSectionResponsibilityObjectModel">
                <value method="setOfficeSectionResponsibilityObjectName"
                    node="object@name" />
            </object>
        </object>
        <object method="setOfficeSubSection" node="sub-section"
            class="net.officefloor.model.office.OfficeSubSectionModel"
            id="SUB_SECTION">
            <value method="setOfficeSubSectionName" node="sub-section@name" />
            <object method="addOfficeSectionManagedObject" node="section-managed-object"
                class="net.officefloor.model.office.OfficeSectionManagedObjectModel">
                <value method="setOfficeSectionManagedObjectName"
                    node="section-managed-object@name" />
                <object method="addOfficeSectionManagedObjectTeam"
                    node="team"
                    class="net.officefloor.model.office.OfficeSectionManagedObjectTeamModel">
                    <value method="setOfficeSectionManagedObjectTeamName"
                        node="team@name" />
                </object>
            </object>
            <object method="addOfficeTask" node="task"
                class="net.officefloor.model.office.OfficeTaskModel">
                <value method="setOfficeTaskName" node="task@name" />
                <object method="addPreDuty" node="pre-administer"
                    class="net.officefloor.model.office.OfficeTaskToPreDutyModel">
                    <value method="setAdministratorName" node="pre-administer@administrator" />
                    <value method="setDutyName" node="pre-administer@duty" />
                </object>
                <object method="addPostDuty" node="post-administer"
                    class="net.officefloor.model.office.OfficeTaskToPostDutyModel">
                    <value method="setAdministratorName" node="post-administer@administrator" />
                    <value method="setDutyName" node="post-administer@duty" />
                </object>
            </object>
            <reference id="SUB_SECTION" method="addOfficeSubSection" />
        </object>
    </object>
</unmarshall>